# If no parameters, display help
if [ -z $1 ]; then
    echo "try:"
    echo "      remount bootpart <ro|rw>"
    echo " -or- remount app      <ro|rw>"
    echo " -or- remount scratch  <ro|rw>"
    exit 1
fi

# Make sure we're running as the root user
if [ $(id -u) -ne 0 ]; then
    sudo $0 $1 $2 $3 $4 $5 $6 $7 $8 $9
fi

# Fetch the name of the partition and the new ro/rw state
part=$1
state=$2

# Ensure we have a state
if [ -z $state ]; then
    echo "Second parameter must be ro or rw"
    exit 1
fi

# Ensure the state is valid
if [ $state != "ro" ] && [ $state != "rw" ]; then
    echo "Second parameter must be ro or rw"
    exit 1
fi

# Translate partition nickname to a partition
test "$part" == "bootpart" && part=mmcblk0p1
test "$part" == "app"      && part=mmcblk0p2
test "$part" == "scratch"  && part=mmcblk0p3

# Remount the desired partition to the desired state
mount -o remount,$state /dev/$part /run/media/$part